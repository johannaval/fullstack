(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{94:function(e,t,n){"use strict";n.r(t);var c=n(0),r=n.n(c),i=n(57),a=n.n(i),s=n(21),o=n.n(s),u=n(28),l=n(30),j=n(5),d=n(1),b=function(e){var t=e.notification;if(!t)return null;var n={borderStyle:"solid",borderRadius:5,padding:10,color:"success"===t.type?"green":"red",background:"lightgrey"};return Object(d.jsx)("div",{style:n,children:t.message})},O=r.a.forwardRef((function(e,t){var n=Object(c.useState)(!1),r=Object(j.a)(n,2),i=r[0],a=r[1],s={display:i?"none":""},o={display:i?"":"none"},u=function(){a(!i)};return Object(c.useImperativeHandle)(t,(function(){return{toggleVisibility:u}})),Object(d.jsxs)("div",{children:[Object(d.jsx)("div",{style:s,children:Object(d.jsx)("button",{onClick:u,children:e.buttonLabel})}),Object(d.jsxs)("div",{style:o,className:"togglableContent",children:[e.children,Object(d.jsx)("button",{onClick:u,children:"cancel"})]})]})}));O.displayName="Togglable";var h=O,f=function(e){var t=Object(c.useState)(""),n=Object(j.a)(t,2),r=n[0],i=n[1],a=Object(c.useState)(""),s=Object(j.a)(a,2),o=s[0],u=s[1],l=Object(c.useState)(""),b=Object(j.a)(l,2),O=b[0],h=b[1];return Object(d.jsxs)("div",{children:[Object(d.jsx)("h2",{children:"create new"}),Object(d.jsxs)("form",{onSubmit:function(t){t.preventDefault(),e.createBlog({title:r,author:o,url:O}),i(""),u(""),h("")},children:[Object(d.jsxs)("div",{children:["author",Object(d.jsx)("input",{id:"author",value:o,onChange:function(e){var t=e.target;return u(t.value)}})]}),Object(d.jsxs)("div",{children:["title",Object(d.jsx)("input",{id:"title",value:r,onChange:function(e){var t=e.target;return i(t.value)}})]}),Object(d.jsxs)("div",{children:["url",Object(d.jsx)("input",{id:"url",value:O,onChange:function(e){var t=e.target;return h(t.value)}})]}),Object(d.jsx)("button",{id:"create",children:"create"})]})]})},x=n(29),p=function(e){var t=e.users;return Object(d.jsxs)("div",{children:[Object(d.jsx)("h1",{children:"Users"}),Object(d.jsxs)("table",{children:[Object(d.jsxs)("tr",{children:[Object(d.jsx)("td",{children:" "}),Object(d.jsxs)("td",{children:[" ",Object(d.jsx)("b",{children:" blogs created "})," "]})]}),t.map((function(e){return Object(d.jsxs)("tr",{children:[Object(d.jsx)("td",{children:Object(d.jsx)("div",{children:Object(d.jsx)(x.b,{to:"/user/".concat(e.id),children:e.name})})}),Object(d.jsxs)("td",{children:[" ",e.blogs.length," "]})]},e.id)}))]})]})},v=function(e){var t=e.user;if(void 0===t)return null;var n=t.blogs;return Object(d.jsxs)("div",{children:[Object(d.jsx)("h1",{children:t.name}),Object(d.jsx)("br",{}),Object(d.jsx)("b",{children:"Added blogs"}),Object(d.jsx)("p",{}),n.map((function(e){return Object(d.jsxs)("li",{children:[" ",e.title]},e.id)}))]})},g=function(e){var t=e.blog,n=e.handleLike,r=e.addComment,i=Object(c.useState)(""),a=Object(j.a)(i,2),s=a[0],o=a[1];return void 0===t?null:Object(d.jsxs)("div",{children:[Object(d.jsx)("h1",{children:t.title}),Object(d.jsx)("a",{href:t.url,children:t.url}),Object(d.jsxs)("p",{children:["likes ",t.likes,Object(d.jsx)("button",{onClick:function(){return n(t.id)},children:"like"})," "]}),Object(d.jsxs)("p",{children:["added by ",t.user.name," "]}),Object(d.jsx)("br",{}),Object(d.jsxs)("form",{onSubmit:function(e){e.preventDefault();var n=t.id;r(n,s),o("")},children:[Object(d.jsx)("div",{children:Object(d.jsx)("input",{id:"comment",value:s,onChange:function(e){var t=e.target;return o(t.value)}})}),Object(d.jsx)("button",{id:"addComment",children:"add comment"})]}),Object(d.jsx)("h3",{children:"Comments"}),t.comments.map((function(e){return Object(d.jsxs)("li",{children:[" ",e.content," "]},e.id)}))]})},m=n(112),k=n(114),S=n(111),w=n(25),y=n.n(w),C="loggedBlogAppUser",E=function(e){return localStorage.setItem(C,JSON.stringify(e))},I=function(){return JSON.parse(localStorage.getItem(C))},B=function(){return localStorage.removeItem(C)},N="/api/blogs",L=function(){return{headers:{Authorization:"bearer ".concat(I().token)}}},D=function(){return y.a.get(N).then((function(e){return e.data}))},J=function(e){return y.a.post(N,e,L()).then((function(e){return e.data}))},T=function(e){return y.a.put("".concat(N,"/").concat(e.id),e,L()).then((function(e){return e.data}))},U=function(e,t){return console.log("t\xe4\xe4ll\xe4 kommentti on: ",t),y.a.post("".concat(N,"/").concat(e,"/comments"),{id:e,comment:t}).then((function(e){return e.data}))},A={login:function(){var e=Object(l.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},R=function(){return y.a.get("/api/users").then((function(e){return e.data}))},V=n(8),z=function(){var e=Object(c.useState)([]),t=Object(j.a)(e,2),n=t[0],i=t[1],a=Object(c.useState)(null),s=Object(j.a)(a,2),u=s[0],O=s[1],p=Object(c.useState)(""),v=Object(j.a)(p,2),g=v[0],m=v[1],k=Object(c.useState)(""),S=Object(j.a)(k,2),w=S[0],y=S[1],C=Object(c.useState)(null),B=Object(j.a)(C,2),N=B[0],L=B[1],T=r.a.createRef();Object(c.useEffect)((function(){D().then((function(e){return i(e)}))}),[]),Object(c.useEffect)((function(){var e=I();O(e)}),[]);var U=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success";L({message:e,type:t}),setTimeout((function(){L(null)}),5e3)},R=function(){var e=Object(l.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,A.login({username:g,password:w});case 4:n=e.sent,m(""),y(""),O(n),U("".concat(n.name," welcome back!")),E(n),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),U("wrong username/password","error");case 15:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}(),V=function(){var e=Object(l.a)(o.a.mark((function e(t){var c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,J(t);case 3:c=e.sent,T.current.toggleVisibility(),i(n.concat(c)),U("a new blog '".concat(c.title,"' by ").concat(c.author," added!")),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}();if(!u)return Object(d.jsxs)("div",{children:[Object(d.jsx)("h2",{children:"login to application"}),Object(d.jsx)(b,{notification:N}),Object(d.jsxs)("form",{onSubmit:R,children:[Object(d.jsxs)("div",{children:["username",Object(d.jsx)("input",{id:"username",value:g,onChange:function(e){var t=e.target;return m(t.value)}})]}),Object(d.jsxs)("div",{children:["password",Object(d.jsx)("input",{id:"password",value:w,onChange:function(e){var t=e.target;return y(t.value)}})]}),Object(d.jsx)("button",{id:"login",children:"login"})]})]});return Object(d.jsxs)("div",{children:[Object(d.jsx)(b,{notification:N}),Object(d.jsx)(h,{buttonLabel:"create new blog",ref:T,children:Object(d.jsx)(f,{createBlog:V})}),n.sort((function(e,t){return t.likes-e.likes})).map((function(e){return Object(d.jsxs)("li",{children:[" ",Object(d.jsxs)(x.b,{to:"/blogs/".concat(e.id),children:[e.title," by ",e.author]})," "]},e.id)}))]})},H=function(){var e=Object(c.useState)([]),t=Object(j.a)(e,2),n=t[0],r=t[1],i=Object(c.useState)([]),a=Object(j.a)(i,2),s=a[0],b=a[1];Object(c.useEffect)((function(){R().then((function(e){return r(e)}))}),[]),Object(c.useEffect)((function(){D().then((function(e){return b(e)}))}),[]);var O=Object(c.useState)(null),h=Object(j.a)(O,2),f=h[0],w=h[1];Object(c.useEffect)((function(){var e=I();w(e)}),[]);var y=Object(V.f)("/user/:id"),C=y?n.find((function(e){return e.id===String(y.params.id)})):null,E=Object(V.f)("/blogs/:id"),N=E?s.find((function(e){return e.id===String(E.params.id)})):null,L=function(){var e=Object(l.a)(o.a.mark((function e(t){var n,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===(n=s.find((function(e){return e.id===t})))){e.next=6;break}return c=Object(u.a)(Object(u.a)({},n),{},{likes:n.likes+1,user:n.user.id}),e.next=5,T(c);case 5:b(s.map((function(e){return e.id===t?Object(u.a)(Object(u.a)({},n),{},{likes:n.likes+1}):e})));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),J=function(){var e=Object(l.a)(o.a.mark((function e(t,n){var c,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("OKEI EI TULE EDES T\xc4NNE? ",t,n),console.log(s),c=s.find((function(e){return e.id===t})),console.log("?????",c),r=Object(u.a)(Object(u.a)({},c),{},{comments:c.comments.concat(n),user:c.user.id}),b(s.map((function(e){return e.id===t?Object(u.a)(Object(u.a)({},r),{},{comments:r.comments.concat(n)}):e}))),e.next=8,U(t,String(n));case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return Object(d.jsxs)("div",{children:[Object(d.jsx)(m.a,{position:"static",children:Object(d.jsxs)(k.a,{children:[Object(d.jsx)(S.a,{color:"inherit",component:x.b,to:"/",children:"Blogs"}),Object(d.jsx)(S.a,{color:"inherit",component:x.b,to:"/users",children:"Users"}),f?Object(d.jsxs)("em",{children:[f.name," logged in ",Object(d.jsx)("button",{onClick:function(){w(null),B()},children:"logout"})," "]}):""]})}),Object(d.jsx)("h1",{children:"Blog app"}),Object(d.jsxs)(V.c,{children:[Object(d.jsx)(V.a,{path:"/user/:id",children:Object(d.jsx)(v,{user:C})}),Object(d.jsx)(V.a,{path:"/users",children:Object(d.jsx)(p,{users:n})}),Object(d.jsx)(V.a,{path:"/blogs/:id",children:Object(d.jsx)(g,{blog:N,handleLike:L,addComment:J})}),Object(d.jsx)(V.a,{path:"/",children:Object(d.jsx)(z,{})})]})]})};a.a.render(Object(d.jsx)(x.a,{children:Object(d.jsx)(H,{})}),document.getElementById("root"))}},[[94,1,2]]]);
//# sourceMappingURL=main.bdc54564.chunk.js.map